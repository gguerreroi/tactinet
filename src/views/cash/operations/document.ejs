<%
var doc = document != undefined ? document : {};
var encabezado = doc.codoperador == "8" ? {
    stragencia: "ELECTROTEL",
    strempresa: "COMINSA, SOCIEDAD ANONIMA",
    strnit: "28163273",
    stractividad: "Servicio de Internet Residencial",
    strdireccion: "6 Avenida 1-70 Zona 4 Tactic A. V.",
    strtelefono: "3667-3866",
    strhorario_sem: "09:00am - 05:30pm",
    strhorario_fs: "09:00am - 01:00pm"
} : {
    stragencia: "SONIVISION",
    strempresa: "Jose Antonio Guerrero",
    strnit: "3563626",
    stractividad: "Servicio de television por cable",
    strdireccion: "1 Calle 4-69 Zona 4 Tactic A. V.",
    strtelefono: "79539140",
    strhorario_sem: "08:30am - 01:00pm y 02:00pm - 05:30pm",
    strhorario_fs: "08:30am - 02:30pm"
};
%>
<!DOCTYPE html>
<html lang="en">
<!--begin::Head-->
<head>
    <%- include('../../components/web-header') %>
</head>
<!--end::Head-->
<!--begin::Body-->
<body id="kt_body"
      class="header-fixed header-tablet-and-mobile-fixed toolbar-enabled toolbar-fixed toolbar-tablet-and-mobile-fixed aside-enabled aside-fixed"
      style="--kt-toolbar-height:55px;--kt-toolbar-height-tablet-and-mobile:55px">
<!--begin::Main-->
<!--begin::Root-->
<div class="d-flex flex-column flex-root">
    <!--begin::Page-->
    <div class="page d-flex flex-row flex-column-fluid">
        <%- include('../../components/left-aside.ejs') %>
        <!--begin::Wrapper-->
        <div class="wrapper d-flex flex-column flex-row-fluid" id="kt_wrapper">
            <!--begin::Header-->
            <div id="kt_header" class="header align-items-stretch">
                <!--begin::Container-->
                <div class="container-fluid d-flex align-items-stretch justify-content-between">
                    <!--begin::Aside mobile toggle-->
                    <div class="d-flex align-items-center d-lg-none ms-n3 me-1" title="Show aside menu">
                        <div class="btn btn-icon btn-active-color-white" id="kt_aside_mobile_toggle">
                            <i class="bi bi-list fs-1"></i>
                        </div>
                    </div>
                    <!--end::Aside mobile toggle-->
                    <!--begin::Mobile logo-->
                    <div class="d-flex align-items-center flex-grow-1 flex-lg-grow-0">
                        <a href="/" class="d-lg-none">
                            <img alt="Logo" src="assets/media/logos/pilar-text3.svg" class="h-25px"/>
                        </a>
                    </div>
                    <!--end::Mobile logo-->
                    <%- include('../../components/top-navbar.ejs', UserInfo) %>
                </div>
                <!--end::Container-->
            </div>
            <!--end::Header-->
            <!--begin::Content-->
            <div class="content d-flex flex-column flex-column-fluid" id="kt_content">
                <div class="d-flex flex-column-fluid">
                    <div class="container">
                        <form id="frmdocumento" method="delete" action="/cash/operations/documents">
                            <div class="card">
                                <div class="card-header pt-10">
                                    <div class="mw-lg-950px mx-auto w-100">
                                        <div class="d-flex justify-content-between flex column flex-sm-row mb-19">
                                            <h4 class="fw-bolder text-gray-800 fs-2qx pe-5 pb-7"><%- doc.coddocumento == 10 ? 'Comprobante de Pago' : 'Documento Tributario Electrónico' %></h4>
                                            <div class="text-sm-end">
                                                <div class="text-sm-end fw-semibold fs-4 text-muted mt-7">
                                                    <div><%= doc.EMISORNOMBRECOMERCIAL %></div>
                                                    <div><%= doc.EMISORNOMBRE %></div>
                                                    <div>NIT: <%= doc.EMISORNIT %></div>
                                                    <div><%= doc.EMISORDIRECCION %></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="pb-5">
                                        <div class="d-flex flex-column gap-7 gap-md-10">
                                            <div class="flex-root d-flex flex-column">
                                                <div class="fw-bold fs-2">
                                                    <span class="fs-5"><%- doc.STRNOMBRESER %></span><br>
                                                    <span class="text-muted fs-5"><%- doc.STRDIRSERVICIO %></span><br>
                                                    <span class="text-muted fs-5"><%- doc.STRNIT %></span>
                                                </div>
                                            </div>
                                            <div class="separator"></div>
                                            <div class="d-flex flex-column flex-sm-row gap-7 gap-md-10 fw-bold">
                                                <div class="flex-root d-flex flex-column">
                                                    <span class="text-muted">Fecha Emision</span>
                                                    <span class="fs-5"><%- doc.FechaHoraEmision %></span>
                                                </div>
                                                <div class="flex-root d-flex flex-column">
                                                    <span class="text-muted">Código Operador</span>
                                                    <span class="fs-5"><%- doc.codoperador %></span>
                                                </div>
                                                <div class="flex-root d-flex flex-column">
                                                    <span class="text-muted">Código Serial</span>
                                                    <span class="fs-5"><%- doc.codserial %></span>
                                                </div>
                                                <div class="flex-root d-flex flex-column">
                                                    <span class="text-muted">Cantidad</span>
                                                    <span class="fs-5"><%- doc.TOTCANTIDAD %></span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="d-flex flex-column gap-7 gap-md-10 fw-bold">
                                            <div class="flex-root d-flex flex-column">
                                                <span  class="text-muted">Número de Autorización</span>
                                                <span><%- doc._uuid %></span>
                                                <span  class="text-muted">Serie</span>
                                                <span><%- doc._serie %></span>
                                                <span  class="text-muted">Número</span>
                                                <span><%- doc._numero %></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="card-footer">
                                    <button type="submit" class="btn btn-danger">REVERSAR</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <!--end::Content-->
            <%- include('../../components/bottom-footer.ejs') %>
        </div>
        <!--end::Wrapper-->
    </div>
    <!--end::Page-->
</div>
<!--end::Root-->
<%- include('../../components/kt-scrolltop') %>
<!--end::Main-->
<%- include('../../components/web-footer') %>
<!--begin::Page Custom Javascript(used by this page)-->
<script src="assets/js/custom/widgets.js"></script>
<!--end::Page Custom Javascript-->

<script>
    "use strict";
    const url = `${window.location.origin}/api`;
    $("#frmdocumento").submit(function (e) {
        e.preventDefault();
        const form = $(this);
        const data = form.serialize();
        const url = form.attr('action');
        const method = form.attr('method');
        $.ajax({
            url: url,
            type: method,
            data: data,
            success: function (data) {
                console.log(data);
                if (data.success) {
                    Swal.fire({
                        title: 'Exito!',
                        text: data.message,
                        type: 'success',
                        confirmButtonText: 'Ok'
                    }).then((result) => {
                        if (result.value) {
                            window.location.href = "/";
                        }
                    });
                } else {
                    Swal.fire({
                        title: 'Error!',
                        text: data.message,
                        type: 'error',
                        confirmButtonText: 'Ok'
                    });
                }
            }
        });
    });

</script>
<!--end::Page Custom Javascript-->
<!--end::Javascript-->
</body>
<!--end::Body-->
</html>